# Installation steps borrowed from NPSV Documentation

yum -y update
yum -y install open-vm-tools
yum -y install wget unzip rsync java-1.8.0-openjdk-headless
shutdown -h now

# Add secondary drive for data (in ESXi)
# Used 70 GB for drive size, THICK Provision for database
# Reboot & log in as root

fdisk /dev/sdb
n (to create a new partition)
p (to make this the primary partition)
1 (select partition 1)
Enter 1 to start format at cylinder 1, or enter first cylinder available
Enter (default to last cylinder to use all space)
w (write partition table & exit)

# Format the drive partition created above
mkfs -t ext4 /dev/sdb1
mkdir /external

# Edit /etc/fstab & add:
/dev/sdb1 /external ext4  defaults  1 1

# Edit /home/admin/.bashrc & add the following to the end of the file:
export JAVA_HOME=/usr/lib/jvm/jre-1.8.0-openjdk

# Reboot, after rebooting, log in as root and confirm secondary drive is present:
df -h

# Revisit time configuration (installed and active by default with CentOS 8)
yum -y install chrony
systemctl start chronyd
systemctl enable chronyd

** Note bmx servers need to be edited to use the internal bmx NTP server

# 
# Open the necessary ports for web services
firewall-cmd --zone=public --permanent --add-port=8111/tcp
firewall-cmd --reload

# Install MariaDB
dnf -y install mariadb-server
systemctl start mariadb
systemctl status mariadb <<== Should show "active (running)"

systemctl enable mariadb

# Securing DB
mysql_secure_installation

mysqladmin -u root -p version
# Set root password = Cs..44, yes to all others

mysqladmin -u root -p version




